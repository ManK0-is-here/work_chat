{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>{{ group.name }}</title>
    <link rel="stylesheet" href="{% static 'css/chat_and_groups.css' %}">
    <link rel="shortcut icon" href="{% static 'image/favicon.ico' %}" type="image/x-icon">
</head>
<body>
<nav class="navbar">
    <div class="pos-logo">
        <a href="{% url 'user_home' %}">
            <img src="{% static 'image/logo2.png' %}" alt="Логотип" class="logo">
        </a>
    </div>

    <div class="pos-search">
        <form method="get" class="grid-search">
            <input class="search-input" name="q" placeholder="Найти группу" 
                type="search" value="{{ request.GET.q }}">
            <button type="submit" class="btn-search"></button>
        </form>
    </div>

    <div class="nav-links">
        <a href="{% url 'profile' %}" class="nav-link">Назад</a>
    </div>
</nav>

<div class="container">
    <aside class="sidebar">
    <h3>{% if search_query %}Результаты поиска{% else %}Мои группы{% endif %}</h3>

    <ul>
        {% if search_query %}
            {% if search_too_short %}
                <li class="muted">Введите минимум 3 символа</li>
            {% else %}
                {% for g in search_results %}
                <li>
                    <div class="row-between">
                    <div class="left">
                        {% if g.icon %}
                        <img src="{{ g.icon.url }}" class="icon">
                        {% else %}
                        <img src="{% static 'images/default_group.png' %}" class="icon">
                        {% endif %}
                        <span>{{ g.name }}</span>
                    </div>
                    <form method="post" action="{% url 'group_join' g.pk %}">
                        {% csrf_token %}
                        <button type="submit" class="btn-join">Вступить</button>
                    </form>
                    </div>
                </li>
                {% empty %}
                <li class="muted">Групп не найдено</li>
                {% endfor %}
            {% endif %}
            {% else %}
            {% for g in groups %}
                <li {% if g.id == current_group_id %}class="active"{% endif %}>
                <a href="{% url 'group_detail' g.pk %}">
                    {% if g.icon %}
                    <img src="{{ g.icon.url }}" class="icon">
                    {% else %}
                    <img src="{% static 'images/default_group.png' %}" class="icon">
                    {% endif %}
                    {{ g.name }}
                </a>
                </li>
            {% empty %}
                <li class="muted">Групп нет</li>
            {% endfor %}
            {% endif %}
        </ul>
    </aside>

    <main class="content">
        {% block content %}
        {% endblock %}
    </main>
</div>
<script src="{% static 'js/main.js' %}"></script>
</body>
</html>
